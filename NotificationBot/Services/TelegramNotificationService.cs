using NotificationsBot.Interfaces;
using NotificationsBot.Models.Locals;
using System.Text.Json;

namespace NotificationsBot.Services;

/// <summary>
/// Сервис уведомления для телеграмм бота
/// </summary>
/// <seealso cref="INotificationService" />
public class TelegramNotificationService : INotificationService
{
    private readonly IHandlerFactory _handlerFactory;
    private readonly ILogger<TelegramNotificationService> _logger;

    public TelegramNotificationService(IHandlerFactory handlerFactory, ILogger<TelegramNotificationService> logger)
    {
        _handlerFactory = handlerFactory;
        _logger = logger;
    }

    public async Task Notify(JsonElement element, string eventType)
    {
        _logger.LogInformation($"Вызов эвента с типом {eventType}");

        if (LocalMessageHandlers.Handlers.TryGetValue(eventType, out Type? handlerType))
        {
            string json = "{\n  \"subscriptionId\": \"96a1c5b4-3de1-4c44-aa8f-4ba46ebacbc5\",\n  \"notificationId\": 61,\n  \"id\": \"aaf59233-7e01-467f-853a-01c949a51beb\",\n  \"eventType\": \"git.pullrequest.updated\",\n  \"publisherId\": \"tfs\",\n  \"message\": {\n    \"text\": \"Almaz I. Akhmetshin approved pull request 6033 (IES.[Server] 1) добавлена проверка на неправильно названный атрибут в xml) in IES\\r\\nhttps://tfs.dev.vitacore.ru/tfs/IES%28agile%29/_git/IES/\",\n    \"html\": \"Almaz I. Akhmetshin approved <a href=\\\"https://tfs.dev.vitacore.ru/tfs/IES%28agile%29/_git/IES/pullrequest/6033\\\">pull request 6033</a> (IES.[Server] 1) добавлена проверка на неправильно названный атрибут в xml) in <a href=\\\"https://tfs.dev.vitacore.ru/tfs/IES%28agile%29/_git/IES/\\\">IES</a>\",\n    \"markdown\": \"Almaz I. Akhmetshin approved [pull request 6033](https://tfs.dev.vitacore.ru/tfs/IES%28agile%29/_git/IES/pullrequest/6033) (IES.[Server] 1) добавлена проверка на неправильно названный атрибут в xml) in [IES](https://tfs.dev.vitacore.ru/tfs/IES%28agile%29/_git/IES/)\"\n  },\n  \"detailedMessage\": {\n    \"text\": \"Almaz I. Akhmetshin approved pull request 6033 (IES.[Server] 1) добавлена проверка на неправильно названный атрибут в xml) in IES\\r\\nhttps://tfs.dev.vitacore.ru/tfs/IES%28agile%29/_git/IES/\\r\\nIES.[Server] 1) добавлена проверка на неправильно названный атрибут в xml\\r\\n\\r\\n2) Исправлена проблема с ФЛК на xsd схеме - возвращалась информация только о первой ошибке в загружаемом xml файле.\\r\\n\",\n    \"html\": \"Almaz I. Akhmetshin approved <a href=\\\"https://tfs.dev.vitacore.ru/tfs/IES%28agile%29/_git/IES/pullrequest/6033\\\">pull request 6033</a> (IES.[Server] 1) добавлена проверка на неправильно названный атрибут в xml) in <a href=\\\"https://tfs.dev.vitacore.ru/tfs/IES%28agile%29/_git/IES/\\\">IES</a><p>IES.[Server] 1) добавлена проверка на неправильно названный атрибут в xml</p><p>2) Исправлена проблема с ФЛК на xsd схеме - возвращалась информация только о первой ошибке в загружаемом xml файле.</p>\",\n    \"markdown\": \"Almaz I. Akhmetshin approved [pull request 6033](https://tfs.dev.vitacore.ru/tfs/IES%28agile%29/_git/IES/pullrequest/6033) (IES.[Server] 1) добавлена проверка на неправильно названный атрибут в xml) in [IES](https://tfs.dev.vitacore.ru/tfs/IES%28agile%29/_git/IES/)\\r\\nIES.[Server] 1) добавлена проверка на неправильно названный атрибут в xml\\r\\n\\r\\n2) Исправлена проблема с ФЛК на xsd схеме - возвращалась информация только о первой ошибке в загружаемом xml файле.\\r\\n\"\n  },\n  \"resource\": {\n    \"repository\": {\n      \"id\": \"2262c954-cf11-42b8-bd11-1a9a34dd2b4b\",\n      \"name\": \"IES\",\n      \"url\": \"https://tfs.dev.vitacore.ru/tfs/a4d6965e-98eb-4d57-b8ba-a8bebaca2a87/_apis/git/repositories/2262c954-cf11-42b8-bd11-1a9a34dd2b4b\",\n      \"project\": {\n        \"id\": \"a4d6965e-98eb-4d57-b8ba-a8bebaca2a87\",\n        \"name\": \"IES(agile)\",\n        \"description\": \"Система АИС Медэксперт-ТФОМС\",\n        \"url\": \"https://tfs.dev.vitacore.ru/tfs/_apis/projects/a4d6965e-98eb-4d57-b8ba-a8bebaca2a87\",\n        \"state\": \"wellFormed\",\n        \"revision\": 823324,\n        \"visibility\": \"private\",\n        \"lastUpdateTime\": \"2025-03-17T04:59:19.01Z\"\n      },\n      \"size\": 152285984,\n      \"remoteUrl\": \"https://tfs.dev.vitacore.ru/tfs/IES%28agile%29/_git/IES\",\n      \"sshUrl\": \"ssh://tfs.dev.vitacore.ru:22/tfs/IES(agile)/_git/IES\",\n      \"webUrl\": \"https://tfs.dev.vitacore.ru/tfs/IES%28agile%29/_git/IES\",\n      \"isDisabled\": false,\n      \"isInMaintenance\": false\n    },\n    \"pullRequestId\": 6033,\n    \"codeReviewId\": 6033,\n    \"status\": \"active\",\n    \"createdBy\": {\n      \"displayName\": \"Danila S. Denisenko\",\n      \"url\": \"https://tfs.dev.vitacore.ru/tfs/_apis/Identities/b2d69784-8105-4072-bd0b-91c08bd6a75e\",\n      \"_links\": {\n        \"avatar\": {\n          \"href\": \"https://tfs.dev.vitacore.ru/tfs/_apis/GraphProfile/MemberAvatars/win.Uy0xLTUtMjEtMjA5MzczODYzNy0yNjk5NzIxNTYyLTEzMDY0MzcyNDctMzgzMA\"\n        }\n      },\n      \"id\": \"b2d69784-8105-4072-bd0b-91c08bd6a75e\",\n      \"uniqueName\": \"DEV\\\\Danila.Denisenko\",\n      \"imageUrl\": \"https://tfs.dev.vitacore.ru/tfs/_api/_common/identityImage?id=b2d69784-8105-4072-bd0b-91c08bd6a75e\",\n      \"descriptor\": \"win.Uy0xLTUtMjEtMjA5MzczODYzNy0yNjk5NzIxNTYyLTEzMDY0MzcyNDctMzgzMA\"\n    },\n    \"creationDate\": \"2025-04-03T14:33:14.7734419Z\",\n    \"title\": \"IES.[Server] 1) добавлена проверка на неправильно названный атрибут в xml\",\n    \"description\": \"IES.[Server] 1) добавлена проверка на неправильно названный атрибут в xml\\n2) Исправлена проблема с ФЛК на xsd схеме - возвращалась информация только о первой ошибке в загружаемом xml файле.\",\n    \"sourceRefName\": \"refs/heads/feature/11525\",\n    \"targetRefName\": \"refs/heads/develop\",\n    \"mergeStatus\": \"succeeded\",\n    \"isDraft\": false,\n    \"mergeId\": \"3b571533-734c-4957-acbc-152c152f5a97\",\n    \"lastMergeSourceCommit\": {\n      \"commitId\": \"994b913a526b294440d7b71a31e7b04b83aeb16b\",\n      \"url\": \"https://tfs.dev.vitacore.ru/tfs/a4d6965e-98eb-4d57-b8ba-a8bebaca2a87/_apis/git/repositories/2262c954-cf11-42b8-bd11-1a9a34dd2b4b/commits/994b913a526b294440d7b71a31e7b04b83aeb16b\"\n    },\n    \"lastMergeTargetCommit\": {\n      \"commitId\": \"a16ebba65234cc9da182498c055fe39770fc55fe\",\n      \"url\": \"https://tfs.dev.vitacore.ru/tfs/a4d6965e-98eb-4d57-b8ba-a8bebaca2a87/_apis/git/repositories/2262c954-cf11-42b8-bd11-1a9a34dd2b4b/commits/a16ebba65234cc9da182498c055fe39770fc55fe\"\n    },\n    \"lastMergeCommit\": {\n      \"commitId\": \"49a2576aff6028bbabd84a65f3a2b1830ddcd570\",\n      \"author\": {\n        \"name\": \"Danila S. Denisenko\",\n        \"email\": \"tinder12347@mail.ru\",\n        \"date\": \"2025-04-03T15:45:57Z\"\n      },\n      \"committer\": {\n        \"name\": \"Danila S. Denisenko\",\n        \"email\": \"tinder12347@mail.ru\",\n        \"date\": \"2025-04-03T15:45:57Z\"\n      },\n      \"comment\": \"Merge pull request 6033 from feature/11525 into develop\",\n      \"url\": \"https://tfs.dev.vitacore.ru/tfs/a4d6965e-98eb-4d57-b8ba-a8bebaca2a87/_apis/git/repositories/2262c954-cf11-42b8-bd11-1a9a34dd2b4b/commits/49a2576aff6028bbabd84a65f3a2b1830ddcd570\"\n    },\n    \"reviewers\": [\n      {\n        \"reviewerUrl\": \"https://tfs.dev.vitacore.ru/tfs/a4d6965e-98eb-4d57-b8ba-a8bebaca2a87/_apis/git/repositories/2262c954-cf11-42b8-bd11-1a9a34dd2b4b/pullRequests/6033/reviewers/0cfc0ad0-6d40-4401-b56f-013615c07f09\",\n        \"vote\": 0,\n        \"hasDeclined\": false,\n        \"isFlagged\": false,\n        \"displayName\": \"Dmitry V. Malashenko\",\n        \"url\": \"https://tfs.dev.vitacore.ru/tfs/_apis/Identities/0cfc0ad0-6d40-4401-b56f-013615c07f09\",\n        \"_links\": {\n          \"avatar\": {\n            \"href\": \"https://tfs.dev.vitacore.ru/tfs/_apis/GraphProfile/MemberAvatars/win.Uy0xLTUtMjEtMjA5MzczODYzNy0yNjk5NzIxNTYyLTEzMDY0MzcyNDctMzgzMQ\"\n          }\n        },\n        \"id\": \"0cfc0ad0-6d40-4401-b56f-013615c07f09\",\n        \"uniqueName\": \"DEV\\\\Dmitry.Malashenko\",\n        \"imageUrl\": \"https://tfs.dev.vitacore.ru/tfs/_api/_common/identityImage?id=0cfc0ad0-6d40-4401-b56f-013615c07f09\"\n      },\n      {\n        \"reviewerUrl\": \"https://tfs.dev.vitacore.ru/tfs/a4d6965e-98eb-4d57-b8ba-a8bebaca2a87/_apis/git/repositories/2262c954-cf11-42b8-bd11-1a9a34dd2b4b/pullRequests/6033/reviewers/17f731a6-f30a-4567-903e-1893e1ed0e4b\",\n        \"vote\": 0,\n        \"hasDeclined\": false,\n        \"isFlagged\": false,\n        \"displayName\": \"Eugeny A. Chekmarev\",\n        \"url\": \"https://tfs.dev.vitacore.ru/tfs/_apis/Identities/17f731a6-f30a-4567-903e-1893e1ed0e4b\",\n        \"_links\": {\n          \"avatar\": {\n            \"href\": \"https://tfs.dev.vitacore.ru/tfs/_apis/GraphProfile/MemberAvatars/win.Uy0xLTUtMjEtMjA5MzczODYzNy0yNjk5NzIxNTYyLTEzMDY0MzcyNDctMzEyNw\"\n          }\n        },\n        \"id\": \"17f731a6-f30a-4567-903e-1893e1ed0e4b\",\n        \"uniqueName\": \"DEV\\\\Eugeny.Chekmarev\",\n        \"imageUrl\": \"https://tfs.dev.vitacore.ru/tfs/_api/_common/identityImage?id=17f731a6-f30a-4567-903e-1893e1ed0e4b\"\n      },\n      {\n        \"reviewerUrl\": \"https://tfs.dev.vitacore.ru/tfs/a4d6965e-98eb-4d57-b8ba-a8bebaca2a87/_apis/git/repositories/2262c954-cf11-42b8-bd11-1a9a34dd2b4b/pullRequests/6033/reviewers/13ddd6ca-0bf7-4d41-a47c-2007ab287253\",\n        \"vote\": 0,\n        \"hasDeclined\": false,\n        \"isFlagged\": false,\n        \"displayName\": \"Alexandr E. Plaksin\",\n        \"url\": \"https://tfs.dev.vitacore.ru/tfs/_apis/Identities/13ddd6ca-0bf7-4d41-a47c-2007ab287253\",\n        \"_links\": {\n          \"avatar\": {\n            \"href\": \"https://tfs.dev.vitacore.ru/tfs/_apis/GraphProfile/MemberAvatars/win.Uy0xLTUtMjEtMjA5MzczODYzNy0yNjk5NzIxNTYyLTEzMDY0MzcyNDctMTM3MQ\"\n          }\n        },\n        \"id\": \"13ddd6ca-0bf7-4d41-a47c-2007ab287253\",\n        \"uniqueName\": \"DEV\\\\Alexandr.Plaksin\",\n        \"imageUrl\": \"https://tfs.dev.vitacore.ru/tfs/_api/_common/identityImage?id=13ddd6ca-0bf7-4d41-a47c-2007ab287253\"\n      },\n      {\n        \"reviewerUrl\": \"https://tfs.dev.vitacore.ru/tfs/a4d6965e-98eb-4d57-b8ba-a8bebaca2a87/_apis/git/repositories/2262c954-cf11-42b8-bd11-1a9a34dd2b4b/pullRequests/6033/reviewers/a980e8c8-c221-4397-8510-22d7c8bb9d8c\",\n        \"vote\": 0,\n        \"hasDeclined\": false,\n        \"isFlagged\": false,\n        \"displayName\": \"Timur R. Galiullin\",\n        \"url\": \"https://tfs.dev.vitacore.ru/tfs/_apis/Identities/a980e8c8-c221-4397-8510-22d7c8bb9d8c\",\n        \"_links\": {\n          \"avatar\": {\n            \"href\": \"https://tfs.dev.vitacore.ru/tfs/_apis/GraphProfile/MemberAvatars/win.Uy0xLTUtMjEtMjA5MzczODYzNy0yNjk5NzIxNTYyLTEzMDY0MzcyNDctMzc5Mw\"\n          }\n        },\n        \"id\": \"a980e8c8-c221-4397-8510-22d7c8bb9d8c\",\n        \"uniqueName\": \"DEV\\\\Timur.Galiullin\",\n        \"imageUrl\": \"https://tfs.dev.vitacore.ru/tfs/_api/_common/identityImage?id=a980e8c8-c221-4397-8510-22d7c8bb9d8c\"\n      },\n      {\n        \"reviewerUrl\": \"https://tfs.dev.vitacore.ru/tfs/a4d6965e-98eb-4d57-b8ba-a8bebaca2a87/_apis/git/repositories/2262c954-cf11-42b8-bd11-1a9a34dd2b4b/pullRequests/6033/reviewers/bce0e530-9fbb-471f-bac4-23b9a5c2574f\",\n        \"vote\": 0,\n        \"hasDeclined\": false,\n        \"isFlagged\": false,\n        \"displayName\": \"Evgeniy Asafov\",\n        \"url\": \"https://tfs.dev.vitacore.ru/tfs/_apis/Identities/bce0e530-9fbb-471f-bac4-23b9a5c2574f\",\n        \"_links\": {\n          \"avatar\": {\n            \"href\": \"https://tfs.dev.vitacore.ru/tfs/_apis/GraphProfile/MemberAvatars/win.Uy0xLTUtMjEtMjA5MzczODYzNy0yNjk5NzIxNTYyLTEzMDY0MzcyNDctMzcyMw\"\n          }\n        },\n        \"id\": \"bce0e530-9fbb-471f-bac4-23b9a5c2574f\",\n        \"uniqueName\": \"DEV\\\\Evgeniy.Asafov\",\n        \"imageUrl\": \"https://tfs.dev.vitacore.ru/tfs/_api/_common/identityImage?id=bce0e530-9fbb-471f-bac4-23b9a5c2574f\"\n      },\n      {\n        \"reviewerUrl\": \"https://tfs.dev.vitacore.ru/tfs/a4d6965e-98eb-4d57-b8ba-a8bebaca2a87/_apis/git/repositories/2262c954-cf11-42b8-bd11-1a9a34dd2b4b/pullRequests/6033/reviewers/df0b135b-beed-4ddb-bcdc-55eb0442f462\",\n        \"vote\": 10,\n        \"hasDeclined\": false,\n        \"isFlagged\": false,\n        \"displayName\": \"Almaz I. Akhmetshin\",\n        \"url\": \"https://tfs.dev.vitacore.ru/tfs/_apis/Identities/df0b135b-beed-4ddb-bcdc-55eb0442f462\",\n        \"_links\": {\n          \"avatar\": {\n            \"href\": \"https://tfs.dev.vitacore.ru/tfs/_apis/GraphProfile/MemberAvatars/win.Uy0xLTUtMjEtMjA5MzczODYzNy0yNjk5NzIxNTYyLTEzMDY0MzcyNDctMzgyOQ\"\n          }\n        },\n        \"id\": \"df0b135b-beed-4ddb-bcdc-55eb0442f462\",\n        \"uniqueName\": \"DEV\\\\Almaz.Akhmetshin\",\n        \"imageUrl\": \"https://tfs.dev.vitacore.ru/tfs/_api/_common/identityImage?id=df0b135b-beed-4ddb-bcdc-55eb0442f462\"\n      },\n      {\n        \"reviewerUrl\": \"https://tfs.dev.vitacore.ru/tfs/a4d6965e-98eb-4d57-b8ba-a8bebaca2a87/_apis/git/repositories/2262c954-cf11-42b8-bd11-1a9a34dd2b4b/pullRequests/6033/reviewers/0f7676a3-9ff4-4e31-9713-aedc08c1ca03\",\n        \"vote\": 0,\n        \"hasDeclined\": false,\n        \"isFlagged\": false,\n        \"displayName\": \"Dmitry I. Tsoy\",\n        \"url\": \"https://tfs.dev.vitacore.ru/tfs/_apis/Identities/0f7676a3-9ff4-4e31-9713-aedc08c1ca03\",\n        \"_links\": {\n          \"avatar\": {\n            \"href\": \"https://tfs.dev.vitacore.ru/tfs/_apis/GraphProfile/MemberAvatars/win.Uy0xLTUtMjEtMjA5MzczODYzNy0yNjk5NzIxNTYyLTEzMDY0MzcyNDctMjY2Mw\"\n          }\n        },\n        \"id\": \"0f7676a3-9ff4-4e31-9713-aedc08c1ca03\",\n        \"uniqueName\": \"DEV\\\\Dmitry.Tsoy\",\n        \"imageUrl\": \"https://tfs.dev.vitacore.ru/tfs/_api/_common/identityImage?id=0f7676a3-9ff4-4e31-9713-aedc08c1ca03\"\n      },\n      {\n        \"reviewerUrl\": \"https://tfs.dev.vitacore.ru/tfs/a4d6965e-98eb-4d57-b8ba-a8bebaca2a87/_apis/git/repositories/2262c954-cf11-42b8-bd11-1a9a34dd2b4b/pullRequests/6033/reviewers/57da0ef2-ebd1-47e4-9e9d-b4fe9678aa64\",\n        \"vote\": 0,\n        \"hasDeclined\": false,\n        \"isFlagged\": false,\n        \"displayName\": \"Sergej E. Nazarov\",\n        \"url\": \"https://tfs.dev.vitacore.ru/tfs/_apis/Identities/57da0ef2-ebd1-47e4-9e9d-b4fe9678aa64\",\n        \"_links\": {\n          \"avatar\": {\n            \"href\": \"https://tfs.dev.vitacore.ru/tfs/_apis/GraphProfile/MemberAvatars/win.Uy0xLTUtMjEtMjA5MzczODYzNy0yNjk5NzIxNTYyLTEzMDY0MzcyNDctMzc4OA\"\n          }\n        },\n        \"id\": \"57da0ef2-ebd1-47e4-9e9d-b4fe9678aa64\",\n        \"uniqueName\": \"DEV\\\\Sergej.Nazarov\",\n        \"imageUrl\": \"https://tfs.dev.vitacore.ru/tfs/_api/_common/identityImage?id=57da0ef2-ebd1-47e4-9e9d-b4fe9678aa64\"\n      },\n      {\n        \"reviewerUrl\": \"https://tfs.dev.vitacore.ru/tfs/a4d6965e-98eb-4d57-b8ba-a8bebaca2a87/_apis/git/repositories/2262c954-cf11-42b8-bd11-1a9a34dd2b4b/pullRequests/6033/reviewers/ef0be9bb-5ae6-47f0-a105-cd11149484fd\",\n        \"vote\": 0,\n        \"hasDeclined\": false,\n        \"isFlagged\": false,\n        \"displayName\": \"Nikita M. Aksinin\",\n        \"url\": \"https://tfs.dev.vitacore.ru/tfs/_apis/Identities/ef0be9bb-5ae6-47f0-a105-cd11149484fd\",\n        \"_links\": {\n          \"avatar\": {\n            \"href\": \"https://tfs.dev.vitacore.ru/tfs/_apis/GraphProfile/MemberAvatars/win.Uy0xLTUtMjEtMjA5MzczODYzNy0yNjk5NzIxNTYyLTEzMDY0MzcyNDctMTQwNQ\"\n          }\n        },\n        \"id\": \"ef0be9bb-5ae6-47f0-a105-cd11149484fd\",\n        \"uniqueName\": \"DEV\\\\Aksinin.Nikita\",\n        \"imageUrl\": \"https://tfs.dev.vitacore.ru/tfs/_api/_common/identityImage?id=ef0be9bb-5ae6-47f0-a105-cd11149484fd\"\n      },\n      {\n        \"reviewerUrl\": \"https://tfs.dev.vitacore.ru/tfs/a4d6965e-98eb-4d57-b8ba-a8bebaca2a87/_apis/git/repositories/2262c954-cf11-42b8-bd11-1a9a34dd2b4b/pullRequests/6033/reviewers/0774eae3-02e4-4d8f-acbf-e26f54af1e29\",\n        \"vote\": 10,\n        \"hasDeclined\": false,\n        \"isFlagged\": false,\n        \"displayName\": \"Dmitry E. Plaksin\",\n        \"url\": \"https://tfs.dev.vitacore.ru/tfs/_apis/Identities/0774eae3-02e4-4d8f-acbf-e26f54af1e29\",\n        \"_links\": {\n          \"avatar\": {\n            \"href\": \"https://tfs.dev.vitacore.ru/tfs/_apis/GraphProfile/MemberAvatars/win.Uy0xLTUtMjEtMjA5MzczODYzNy0yNjk5NzIxNTYyLTEzMDY0MzcyNDctMTE1Mw\"\n          }\n        },\n        \"id\": \"0774eae3-02e4-4d8f-acbf-e26f54af1e29\",\n        \"uniqueName\": \"DEV\\\\Dmitry.Plaksin\",\n        \"imageUrl\": \"https://tfs.dev.vitacore.ru/tfs/_api/_common/identityImage?id=0774eae3-02e4-4d8f-acbf-e26f54af1e29\"\n      }\n    ],\n    \"url\": \"https://tfs.dev.vitacore.ru/tfs/a4d6965e-98eb-4d57-b8ba-a8bebaca2a87/_apis/git/repositories/2262c954-cf11-42b8-bd11-1a9a34dd2b4b/pullRequests/6033\",\n    \"_links\": {\n      \"web\": {\n        \"href\": \"https://tfs.dev.vitacore.ru/tfs/IES%28agile%29/_git/IES/pullrequest/6033\"\n      },\n      \"statuses\": {\n        \"href\": \"https://tfs.dev.vitacore.ru/tfs/a4d6965e-98eb-4d57-b8ba-a8bebaca2a87/_apis/git/repositories/2262c954-cf11-42b8-bd11-1a9a34dd2b4b/pullRequests/6033/statuses\"\n      }\n    },\n    \"completionOptions\": {\n      \"mergeCommitMessage\": \"Merged PR 6033: IES.[Server] 1) добавлена проверка на неправильно названный атрибут в xml\\n\\nIES.[Server] 1) добавлена проверка на неправильно названный атрибут в xml\\n2) Исправлена проблема с ФЛК на xsd схеме - возвращалась информация только о первой ошибке в загружаемом xml файле.\\n\\nRelated work items: #11525\",\n      \"mergeStrategy\": \"noFastForward\",\n      \"transitionWorkItems\": true,\n      \"autoCompleteIgnoreConfigIds\": [\n        190\n      ]\n    },\n    \"supportsIterations\": true,\n    \"autoCompleteSetBy\": {\n      \"displayName\": \"Dmitry E. Plaksin\",\n      \"url\": \"https://tfs.dev.vitacore.ru/tfs/_apis/Identities/0774eae3-02e4-4d8f-acbf-e26f54af1e29\",\n      \"_links\": {\n        \"avatar\": {\n          \"href\": \"https://tfs.dev.vitacore.ru/tfs/_apis/GraphProfile/MemberAvatars/win.Uy0xLTUtMjEtMjA5MzczODYzNy0yNjk5NzIxNTYyLTEzMDY0MzcyNDctMTE1Mw\"\n        }\n      },\n      \"id\": \"0774eae3-02e4-4d8f-acbf-e26f54af1e29\",\n      \"uniqueName\": \"DEV\\\\Dmitry.Plaksin\",\n      \"imageUrl\": \"https://tfs.dev.vitacore.ru/tfs/_api/_common/identityImage?id=0774eae3-02e4-4d8f-acbf-e26f54af1e29\",\n      \"descriptor\": \"win.Uy0xLTUtMjEtMjA5MzczODYzNy0yNjk5NzIxNTYyLTEzMDY0MzcyNDctMTE1Mw\"\n    },\n    \"artifactId\": \"vstfs:///Git/PullRequestId/a4d6965e-98eb-4d57-b8ba-a8bebaca2a87%2f2262c954-cf11-42b8-bd11-1a9a34dd2b4b%2f6033\"\n  },\n  \"resourceVersion\": \"1.0-preview.1\",\n  \"resourceContainers\": {\n    \"collection\": {\n      \"id\": \"14ed7439-51c3-4522-8939-cc6e31156c6a\",\n      \"baseUrl\": \"https://tfs.dev.vitacore.ru/tfs/\"\n    },\n    \"server\": {\n      \"id\": \"ba7421f6-fa42-4018-85b5-f7c14112d595\",\n      \"baseUrl\": \"https://tfs.dev.vitacore.ru/\"\n    },\n    \"project\": {\n      \"id\": \"a4d6965e-98eb-4d57-b8ba-a8bebaca2a87\",\n      \"baseUrl\": \"https://tfs.dev.vitacore.ru/tfs/\"\n    }\n  },\n  \"createdDate\": \"2025-04-03T15:51:41.3986358Z\"\n}\n";

            await _handlerFactory.ProcessHandler(handlerType, json);
        }
    }
}


